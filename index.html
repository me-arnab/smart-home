<!DOCTYPE html>
<html>

<head>
    <title>Arnab Smart Home</title>
    <style>
        body {
            font-family: Arial;
            text-align: center;
            background: #f4f4f4;
        }

        button {
            margin: 10px;
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
        }

        .on {
            background: #4CAF50;
            color: white;
        }

        .off {
            background: #f44336;
            color: white;
        }
    </style>
</head>

<body>
    <h2>Arnab Smart Home</h2>

    <div id="controls">
        <button id="b1on" class="on" onclick="send('relay1_on')">Light 1 ON</button>
        <button id="b1off" class="off" onclick="send('relay1_off')">Light 1 OFF</button><br>
        <button id="b2on" class="on" onclick="send('relay2_on')">Light 2 ON</button>
        <button id="b2off" class="off" onclick="send('relay2_off')">Light 2 OFF</button><br>
        <button id="b3on" class="on" onclick="send('relay3_on')">Fan ON</button>
        <button id="b3off" class="off" onclick="send('relay3_off')">Fan OFF</button><br>
        <button id="b4on" class="on" onclick="send('relay4_on')">Extra ON</button>
        <button id="b4off" class="off" onclick="send('relay4_off')">Extra OFF</button>
    </div>

    <script>
        const ws = new WebSocket("wss://arnab-smart.onrender.com");
        ws.onopen = () => console.log("âœ… Connected");

        function send(cmd) { ws.send(cmd); }

        ws.onmessage = (event) => {
            if (event.data.startsWith("state:")) {
                const states = event.data.split(":")[1].split(",").map(s => s === "1" || s === "true");
                updateButtons(states);
            }
        };

        function updateButtons(states) {
            for (let i = 0; i < states.length; i++) {
                const onBtn = document.getElementById(`b${i + 1}on`);
                const offBtn = document.getElementById(`b${i + 1}off`);
                if (states[i]) {
                    onBtn.style.opacity = "1.0";
                    offBtn.style.opacity = "0.4";
                } else {
                    onBtn.style.opacity = "0.4";
                    offBtn.style.opacity = "1.0";
                }
            }
        }
    </script>
</body>

</html>